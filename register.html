<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Sign In | Bizzy</title>

    <link rel="stylesheet" href="css/style.css">

    <style>
        #main-content {
            background-color: #f2f2f2;
            border: 1px solid #ccc;
            padding: 20px;
            margin: 20px;
        }

        #button-container {
            display: flex;
            margin: 20px auto;
            width: 80%;
            justify-content: space-evenly;
            gap: 20px;
        }

        #button-container button {
            padding: 6px;
        }


        #button-container button.btn-on {
            font-weight: bold;
        }

        label {
            display: block;
        }

        select {
            margin: 8px 0;
            padding: 4px;
            text-align: center;
        }
    </style>

    <script type="text/javascript">
        let locationData;

        async function setupLocationDropdown() {
            let response = await fetch("/saigon3.json").then((r) => r.json());
            locationData = response['district'];

            let districtDropdown = document.querySelector("[name='district']");
            let html = '';
            locationData.forEach(d => {
                html += `<option value="${d["code"]}">${d["name"]}</option>`;
            });
            districtDropdown.innerHTML = html;

            let onDistrictChange = function () {
                // console.log(this.value);

                let districtData = locationData.find(e => e["code"] == this.value);
                let html = '';
                districtData["ward"].forEach(w => {
                    html += `<option value="${w["code"]}">${w["name"]}</option>`;
                });
                document.querySelector("[name='ward']").innerHTML = html;
            };

            districtDropdown.addEventListener("change", onDistrictChange);

            onDistrictChange.apply(districtDropdown);
        }

        window.addEventListener("load", function () {
            document.getElementById("register-button").addEventListener("click", function () {
                // Switch form contents
                document.getElementById("register-form").style.display = "block";
                document.getElementById("existing-account-form").style.display = "none";

                // Toggle button class
                document.getElementById("register-button").classList.add('btn-on');
                document.getElementById("existing-account-button").classList.remove('btn-on');
            });
            document.getElementById("existing-account-button").addEventListener("click", function () {
                // Switch form contents
                document.getElementById("register-form").style.display = "none";
                document.getElementById("existing-account-form").style.display = "block";

                // Toggle button class
                document.getElementById("register-button").classList.remove('btn-on');
                document.getElementById("existing-account-button").classList.add('btn-on');
            });

            setupLocationDropdown();
        });


        // function asdf() {
        //     let totalSql = "";

        //     // INSERT INTO basic_address (type, pretty_name, code, lat, lng) VALUES ('[value-2]','[value-3]','[value-4]','[value-5]','[value-6]')
        //     locationData.forEach(district => {
        //         let sql = `INSERT INTO basic_address (type, pretty_name, code, lat, lng) VALUES ('${"district"}','${district["name"]}','${district["code"]}',NULL,NULL);`;
        //         totalSql += sql + "\n";

        //         district["ward"].forEach(ward => {
        //             let sql = `INSERT INTO basic_address (type, pretty_name, code, lat, lng, dummy) VALUES ('${"ward"}','${ward["name"]}','${ward["code"]}',NULL,NULL, '${district["code"]}');`;
        //             totalSql += sql + "\n";
        //         });
        //     });

        //     console.log(totalSql);
        // }

        // asdf();
    </script>
</head>

<body>
    <div id="sign-up-screen">
        <div id="button-container">
            <button id="register-button" class="btn-on">Register</button>
            <button id="existing-account-button">Existing Account</button>
        </div>
        <div id="main-content">
            <div id="register-form">
                <!-- Form elements for registering a new account -->
                <form method="post" action="/svr/register.php" enctype="multipart/form-data">
                    <!-- Account info -->
                    <label for="email">Email:</label>
                    <input type="email" id="email" name="email"><br>
                    <label for="phone">Phone Number:</label>
                    <input type="phone" id="phone" name="phone"><br>
                    <label for="password">Password:</label>
                    <input type="password" id="password" name="password"><br>

                    <!-- Business info -->
                    <br>
                    <label for="biz_name">Business Name:</label>
                    <input type="text" id="biz_name" name="biz_name"><br>
                    <label for="descr">Description:</label>
                    <input type="text" id="descr" name="descr"><br>
                    <label for="website">Website:</label>
                    <input type="text" id="website" name="website"><br>

                    <!-- Business trade -->
                    <select name="trade">
                        <option value="electrician">Electrician</option>
                        <option value="plumber">Plumber</option>
                        <option value="carpenter">Carpenter</option>
                        <option value="hvac">HVAC technician</option>
                        <option value="welder">Welder</option>
                        <option value="mechanic">Mechanic</option>
                        <option value="painter">Painter</option>
                        <option value="roofer">Roofer</option>
                        <option value="mason">Mason</option>
                        <option value="landscaper">Landscaper</option>
                        <option value="drywall">Drywall installer</option>
                        <option value="insulator">Insulator</option>
                        <option value="concrete">Concrete worker</option>
                        <option value="glazier">Glazier</option>
                        <option value="flooring">Flooring installer</option>
                        <option value="sheetmetal">Sheet metal worker</option>
                        <option value="bricklayer">Bricklayer</option>
                        <option value="ironworker">Ironworker</option>
                    </select>
                    <br>

                    <!-- Business location (loaded dynamically) -->
                    <select name="district">
                    </select>
                    <select name="ward">
                    </select>
                    <br>

                    <input type="file" name="image">
                    <br>
                    <br>

                    <input type="submit" value="Submit">
                </form>
            </div>
            <div id="existing-account-form" style="display:none">
                <!-- Form elements for logging into an existing account -->
                <form method="post" action="/svr/login.php">
                    <label for="login">Login:</label>
                    <input type="text" id="login" name="login" placeholder="Email or Phone"><br>
                    <label for="password">Password:</label>
                    <input type="password" id="password" name="password"><br>
                    <input type="submit" value="Submit">
                </form>
            </div>
        </div>
    </div>
</body>

</html>